name: Notify

on:
  push:
    branches:
      - main

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      - name: Send notification
        run: |
          # åŸºæœ¬è½¬ä¹‰å¤„ç†
          MESSAGE=$(echo '${{ github.event.head_commit.message }}' | sed 's/"/\\"/g')
          AUTHOR="${{ github.event.head_commit.author.name || github.actor }}"
          
          curl -X POST \
            "https://${{ secrets.APIURL }}/send_group_msg" \
            -H "Authorization: Bearer ${{ secrets.APITOKEN }}" \
            -H "Content-Type: application/json" \
            -d "{
              \"group_id\": \"1053570434\",
              \"message\": [
                {
                  \"type\": \"text\",
                  \"data\": {
                    \"text\": \"ğŸ“¢ ä¸»åˆ†æ”¯å·²æ›´æ–°ï¼\n\nğŸ‘¤ ä½œè€…: $AUTHOR\nğŸ“ æè¿°: $MESSAGE\nğŸ”— æäº¤: ${{ github.sha }}\"
                  }
                }
              ]
            }"
